!function(){"use strict";class e{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked||!1,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteConfirm=r,this._handleLikeClick=i}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this).then((e=>{this._isLiked=e,this.renderLikes(this._isLiked)}))})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteConfirm()})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}renderLikes(e){this._isLiked=e,e?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}getLikes(){return this._isLiked}removeCard(){this._cardElement.remove(),this._cardElement=null}getView(){return this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImageEl=this._cardElement.querySelector(".card__photo"),this.cardNameEl=this._cardElement.querySelector(".card__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this.cardNameEl.textContent=this._name,this.renderLikes(this._isLiked),this._setEventListeners(),this._cardElement}getId(){return this._id}}var t=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._setEventListeners(),this._toggleButtonState()}_showError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._inputErrorClass)}_checkInputValidity(e){e.validity.valid?this._hideError(e):this._showError(e)}_toggleButtonState(){const e=this._hasInvalidInput(this._inputEls),t=this._inputEls.every((e=>""===e.value.trim()));e||t?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_setEventListeners(){this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._inputEls.forEach((e=>{this._hideError(e)})),this.disableButton()}enableValidation(){this._setEventListeners()}reset(){this._form.reset()}};class s{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){let{popupSelector:t}=e;this._popup=document.querySelector(t),this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close-button"),this._handleEscClose=this._handleEscClose.bind(this),this._handleOverlayClose=this._handleOverlayClose.bind(this)}_handleOverlayClose(e){e.target===this._popupElement&&this.close()}_handleEscClose(e){"Escape"===e.key&&this.close()}open(){this._popupElement.classList.add("modal_is-opened"),document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleOverlayClose)}close(){this._popupElement.classList.remove("modal_is-opened"),document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("click",this._handleOverlayClose)}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()}))}}class i extends r{constructor(e,t){super({popupSelector:e}),this._handleFormSubmit=t,this._popupForm=this._popup.querySelector(".modal__form"),this._popupForm?(this._submitBtn=this._popupForm.querySelector(".modal__save-button, .confirm__modal-button"),this._submitBtn?(this._submitBtnText=this._submitBtn.textContent,this._inputList=Array.from(this._popupForm.querySelectorAll(".modal__input"))):console.error(`Submit button not found in form with selector: ${e}`)):console.error(`Form not found in popup with selector: ${e}`)}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn&&(e?(this._submitBtn.textContent=t,this._submitBtn.disabled=!0):(this._submitBtn.textContent=this._submitBtnText,this._submitBtn.disabled=!1))}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputsValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}}const n={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},o=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}initialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}postCards(e){let{name:t,link:s,_id:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:s,_id:r})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}editUserInfo(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}updateProfilePicture(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"9a2a6717-e342-435d-a8a9-13aa291b9ad5","Content-Type":"application/json"}}),a=document.querySelector("#profile-edit-button"),l=document.querySelector("#profile-edit-modal").querySelector("#editProfileForm"),d=document.querySelector(".pencil-icon"),c=document.querySelector("#profile-picture-modal"),h=c.querySelector("#profile-picture-form"),u=(c.querySelector("#profile-picture-save"),new class{constructor(e,t,s){this._nameElement=document.querySelector(e),this._aboutElement=document.querySelector(t),this._avatarElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,about:this._aboutElement.textContent,avatar:this._avatarElement?this._avatarElement.src:null}}setUserInfo(e,t,s){this._nameElement.textContent=e,this._aboutElement.textContent=t,s&&this._avatarElement&&(this._avatarElement.src=s)}}(".profile__title",".profile__description",".profile__picture"));o.getUserInfo().then((e=>{u.setUserInfo(e.name,e.about,e.avatar)})).catch((e=>{console.error("Error fetching user info:",e)}));const _=new t(n,l);_.enableValidation(),a.addEventListener("click",(()=>{const e=u.getUserInfo();m.setInputsValues(e),m.open(),_.resetValidation()}));const m=new i("#profile-edit-modal",(function(e){m.renderLoading(!0),o.editUserInfo(e).then((e=>{u.setUserInfo(e.name,e.about,e.avatar),m.close(),l.reset(),_.disableButton()})).catch((e=>{console.error("Error updating profile:",e)})).finally((()=>{m.renderLoading(!1)}))}));m.setEventListeners();const p=new t(n,h);p.enableValidation(),d.addEventListener("click",(()=>{E.open(),p.resetValidation()}));const E=new i("#profile-picture-modal",(function(e){const t=e.newProfilePictureUrl;E.renderLoading(!0),o.updateProfilePicture(t).then((e=>{u.setUserInfo(e.name,e.about,e.avatar),E.close(),p.disableButton(),p.reset()})).catch((e=>{console.error("Error updating profile picture:",e)})).finally((()=>{E.renderLoading(!1)}))}));E.setEventListeners();const v=document.querySelector("#profile-card-modal"),b=document.querySelector(".profile__add-button"),f=v.querySelector("#newCardForm"),L=(v.querySelector("#card-save"),"#card-template"),k=new t(n,f);k.enableValidation(),b.addEventListener("click",(e=>{C.open(),k.resetValidation()}));const C=new i("#profile-card-modal",(function(e){C.renderLoading(!0),o.postCards(e).then((e=>{const t=I(e);w.addItem(t),C.close(),k.disableButton(),k.reset()})).catch((e=>{console.error("Error adding new card:",e)})).finally((()=>{C.renderLoading(!1)}))}));C.setEventListeners();const y=new i("#confirmation-modal",(function(){y.renderLoading(!0),o.deleteCard(S.getId()).then((()=>{S.removeCard(),y.close()})).catch((e=>{console.error("Error deleting card:",e),hideSavingText(deleteCardSaveButton)})).finally((()=>{y.renderLoading(!1)}))}));y.setEventListeners();let S=null;const g=new class extends r{constructor(e){super({popupSelector:e}),this._popupImage=this._popupElement.querySelector(".modal__preview-image"),this._popupTitle=this._popupElement.querySelector(".modal__preview-title")}open(e){this._popupImage.src=e.link,this._popupTitle.textContent=e.name,this._popupImage.alt=e.name,super.open()}}("#preview-modal-image");function B(e,t){g.open(e,t)}function I(t){const s=new e(t,L,B,(()=>function(e){S=e,y.open()}(s)),q);return s.getView()}function q(e){return e.getLikes()?o.unlikeCard(e.getId()).then((t=>(e.renderLikes(!1),!1))).catch((e=>{throw console.error("Error unliking card:",e),e})):o.likeCard(e.getId()).then((t=>(e.renderLikes(!0),!0))).catch((e=>{throw console.error("Error liking card:",e),e}))}g.setEventListeners();const w=new s({items:[],renderer:e=>{const t=I(e);w.addItem(t)}},".cards__list");o.initialCards().then((e=>{const t=new s({items:e,renderer:e=>{const s=I(e);t.addItem(s)}},".cards__list");t.renderItems()})).catch((e=>{console.error("Error loading initial cards:",e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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L3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL1V0aWxzL0NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNvbmZpcm0sXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2lzTGlrZWQgPSBkYXRhLmlzTGlrZWQgfHwgZmFsc2U7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm0gPSBoYW5kbGVEZWxldGVDb25maXJtO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgfVxuXG4gIF9nZXRUZW1wbGF0ZSgpIHtcbiAgICBjb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xuICAgIHJldHVybiBjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKS50aGVuKChpc0xpa2VkKSA9PiB7XG4gICAgICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xuICAgICAgICB0aGlzLnJlbmRlckxpa2VzKHRoaXMuX2lzTGlrZWQpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm0oKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlbmRlckxpa2VzKGlzTGlrZWQpIHtcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICBpZiAoaXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgZ2V0TGlrZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQ7XG4gIH1cblxuICByZW1vdmVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19waG90b1wiKTtcbiAgICB0aGlzLmNhcmROYW1lRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMuY2FyZE5hbWVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cbiAgICB0aGlzLnJlbmRlckxpa2VzKHRoaXMuX2lzTGlrZWQpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBnZXRJZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faWQ7XG4gIH1cbn1cbiIsIi8vIGltcG9ydCB7IFNldHRpbmdzIH0gZnJvbSBcIi4uL1V0aWxzL0NvbnN0YW50cy5qc1wiO1xuXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgfVxuXG4gIF9zaG93RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCkge1xuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0Vycm9yKGlucHV0RWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICB9XG5cbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGNvbnN0IGlzSW5wdXRJbnZhbGlkID0gdGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxzKTtcbiAgICBjb25zdCBpc0Zvcm1FbXB0eSA9IHRoaXMuX2lucHV0RWxzLmV2ZXJ5KFxuICAgICAgKGlucHV0RWwpID0+IGlucHV0RWwudmFsdWUudHJpbSgpID09PSBcIlwiXG4gICAgKTtcblxuICAgIGlmIChpc0lucHV0SW52YWxpZCB8fCBpc0Zvcm1FbXB0eSkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGVuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxuXG4gIGRpc2FibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSB7XG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsKSA9PiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXRFbCk7XG4gICAgfSk7XG4gICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldCgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiXG4gICAgKTtcblxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UgPSB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UuYmluZCh0aGlzKTtcbiAgfVxuXG4gIF9oYW5kbGVPdmVybGF5Q2xvc2UoZXZ0KSB7XG4gICAgaWYgKGV2dC50YXJnZXQgPT09IHRoaXMuX3BvcHVwRWxlbWVudCkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9pcy1vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfaXMtb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlT3ZlcmxheUNsb3NlKTtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbiAgICBpZiAoIXRoaXMuX3BvcHVwRm9ybSkge1xuICAgICAgY29uc29sZS5lcnJvcihgRm9ybSBub3QgZm91bmQgaW4gcG9wdXAgd2l0aCBzZWxlY3RvcjogJHtwb3B1cFNlbGVjdG9yfWApO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19zYXZlLWJ1dHRvbiwgLmNvbmZpcm1fX21vZGFsLWJ1dHRvblwiXG4gICAgKTtcbiAgICBpZiAoIXRoaXMuX3N1Ym1pdEJ0bikge1xuICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgYFN1Ym1pdCBidXR0b24gbm90IGZvdW5kIGluIGZvcm0gd2l0aCBzZWxlY3RvcjogJHtwb3B1cFNlbGVjdG9yfWBcbiAgICAgICk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fc3VibWl0QnRuVGV4dCA9IHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudDtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpXG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgICBpZiAodGhpcy5fc3VibWl0QnRuKSB7XG4gICAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgICAgICB0aGlzLl9zdWJtaXRCdG4uZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnRuVGV4dDtcbiAgICAgICAgdGhpcy5fc3VibWl0QnRuLmRpc2FibGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcbiAgfVxuXG4gIHNldElucHV0c1ZhbHVlcyhkYXRhKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XG4gICAgfSk7XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImNvbnN0IGNhcmREYXRhID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmNvbnN0IFNldHRpbmdzID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuXG5leHBvcnQgeyBjYXJkRGF0YSwgU2V0dGluZ3MgfTtcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcblxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcblxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5cbmltcG9ydCB7IFNldHRpbmdzIH0gZnJvbSBcIi4uL1V0aWxzL0NvbnN0YW50cy5qc1wiO1xuXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcblxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5cbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbi8vIEFQSVxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiOWEyYTY3MTctZTM0Mi00MzVkLWE4YTktMTNhYTI5MWI5YWQ1XCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuLyoqKioqKioqKioqXG4gKiBQcm9maWxlICpcbiAqKioqKioqKioqKi9cblxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdFByb2ZpbGVGb3JtXCIpO1xuXG4vKioqKioqKioqKioqKioqKioqKlxuICogUHJvZmlsZSBQaWN0dXJlICpcbiAqKioqKioqKioqKioqKioqKioqL1xuXG5jb25zdCBwcm9maWxlUGljdHVyZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGVuY2lsLWljb25cIik7XG5jb25zdCBwcm9maWxlUGljdHVyZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXBpY3R1cmUtbW9kYWxcIik7XG5jb25zdCBwcm9maWxlUGljdHVyZUZvcm0gPSBwcm9maWxlUGljdHVyZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtcGljdHVyZS1mb3JtXCJcbik7XG5jb25zdCBwcm9maWxlUGljdHVyZVNhdmVCdXR0b24gPSBwcm9maWxlUGljdHVyZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtcGljdHVyZS1zYXZlXCJcbik7XG5cbi8qKioqKioqKioqKioqXG4gKiBVc2VyIEluZm8gKlxuICoqKioqKioqKioqKiovXG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxuICBcIi5wcm9maWxlX190aXRsZVwiLFxuICBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICBcIi5wcm9maWxlX19waWN0dXJlXCJcbik7XG5cbmFwaVxuICAuZ2V0VXNlckluZm8oKVxuICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCwgdXNlckRhdGEuYXZhdGFyKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdXNlciBpbmZvOlwiLCBlcnIpO1xuICB9KTtcblxuLyoqKioqKioqKioqKioqKlxuICogUHJvZmlsZUVkaXQgKlxuICoqKioqKioqKioqKioqKi9cbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoU2V0dGluZ3MsIHByb2ZpbGVFZGl0Rm9ybSk7XG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IGN1cnJlbnRVc2VySW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVQb3B1cC5zZXRJbnB1dHNWYWx1ZXMoY3VycmVudFVzZXJJbmZvKTtcbiAgcHJvZmlsZVBvcHVwLm9wZW4oKTtcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcblxuLyoqKioqKioqKioqKioqKioqKlxuICogUHJvZmlsZSBTdWJtaXQgKlxuICoqKioqKioqKioqKioqKioqKi9cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZm9ybVZhbHVlcykge1xuICBwcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcblxuICBhcGlcbiAgICAuZWRpdFVzZXJJbmZvKGZvcm1WYWx1ZXMpXG4gICAgLnRoZW4oKGVkaXRVc2VySW5mbykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oXG4gICAgICAgIGVkaXRVc2VySW5mby5uYW1lLFxuICAgICAgICBlZGl0VXNlckluZm8uYWJvdXQsXG4gICAgICAgIGVkaXRVc2VySW5mby5hdmF0YXJcbiAgICAgICk7XG5cbiAgICAgIHByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgICAgcHJvZmlsZUVkaXRGb3JtLnJlc2V0KCk7XG4gICAgICBlZGl0Rm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHByb2ZpbGU6XCIsIGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBwcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXRcbik7XG5wcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLyoqKioqKioqKioqKioqKioqKioqKioqKipcbiAqIFByb2ZpbGUgUGljdHVyZSBNb2RhbCAqXG4gKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuY29uc3QgcHJvZmlsZVBpY3R1cmVGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIFNldHRpbmdzLFxuICBwcm9maWxlUGljdHVyZUZvcm1cbik7XG5wcm9maWxlUGljdHVyZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5wcm9maWxlUGljdHVyZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwcm9maWxlUGljdHVyZVBvcHVwLm9wZW4oKTtcbiAgcHJvZmlsZVBpY3R1cmVGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoZm9ybVZhbHVlcykge1xuICBjb25zdCBuZXdQcm9maWxlUGljdHVyZVVybCA9IGZvcm1WYWx1ZXMubmV3UHJvZmlsZVBpY3R1cmVVcmw7XG4gIHByb2ZpbGVQaWN0dXJlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcblxuICBhcGlcbiAgICAudXBkYXRlUHJvZmlsZVBpY3R1cmUobmV3UHJvZmlsZVBpY3R1cmVVcmwpXG4gICAgLnRoZW4oKHVwZGF0ZWRVc2VyKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhcbiAgICAgICAgdXBkYXRlZFVzZXIubmFtZSxcbiAgICAgICAgdXBkYXRlZFVzZXIuYWJvdXQsXG4gICAgICAgIHVwZGF0ZWRVc2VyLmF2YXRhclxuICAgICAgKTtcbiAgICAgIHByb2ZpbGVQaWN0dXJlUG9wdXAuY2xvc2UoKTtcbiAgICAgIHByb2ZpbGVQaWN0dXJlRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICBwcm9maWxlUGljdHVyZUZvcm1WYWxpZGF0b3IucmVzZXQoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgcHJvZmlsZSBwaWN0dXJlOlwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcHJvZmlsZVBpY3R1cmVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuY29uc3QgcHJvZmlsZVBpY3R1cmVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLXBpY3R1cmUtbW9kYWxcIixcbiAgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdFxuKTtcbnByb2ZpbGVQaWN0dXJlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLyoqKioqKioqXG4gKiBDYXJkICpcbiAqKioqKioqKi9cblxuY29uc3QgcHJvZmlsZUNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1jYXJkLW1vZGFsXCIpO1xuY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmNvbnN0IGFkZENhcmRGb3JtID0gcHJvZmlsZUNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI25ld0NhcmRGb3JtXCIpO1xuY29uc3QgYWRkQ2FyZFN1Ym1pdEJ0biA9IHByb2ZpbGVDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNjYXJkLXNhdmVcIik7XG5jb25zdCBjYXJkU2VsZWN0b3IgPSBcIiNjYXJkLXRlbXBsYXRlXCI7XG5cbi8qKioqKioqKioqKioqKioqXG4gKiBBZGQgTmV3IENhcmQgKlxuICoqKioqKioqKioqKioqKiovXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoU2V0dGluZ3MsIGFkZENhcmRGb3JtKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcblxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGUtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdFxuKTtcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdChkYXRhKSB7XG4gIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuXG4gIGFwaVxuICAgIC5wb3N0Q2FyZHMoZGF0YSlcbiAgICAudGhlbigobmV3Q2FyZCkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKG5ld0NhcmQpO1xuICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xuICAgICAgYWRkRm9ybVZhbGlkYXRvci5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0KCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFkZGluZyBuZXcgY2FyZDpcIiwgZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqXG4gKiBkZWxldGUgY2FyZCBjb25maXJtICpcbiAqKioqKioqKioqKioqKioqKioqKioqKi9cblxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI2NvbmZpcm1hdGlvbi1tb2RhbFwiLFxuICBoYW5kbGVEZWxldGVDb25maXJtXG4pO1xuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmxldCBjdXJyZW50Q2FyZFRvRGVsZXRlID0gbnVsbDtcblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZCkge1xuICBjdXJyZW50Q2FyZFRvRGVsZXRlID0gY2FyZDtcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ29uZmlybSgpIHtcbiAgZGVsZXRlQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC5kZWxldGVDYXJkKGN1cnJlbnRDYXJkVG9EZWxldGUuZ2V0SWQoKSlcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICBjdXJyZW50Q2FyZFRvRGVsZXRlLnJlbW92ZUNhcmQoKTtcbiAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBjYXJkOlwiLCBlcnIpO1xuICAgICAgaGlkZVNhdmluZ1RleHQoZGVsZXRlQ2FyZFNhdmVCdXR0b24pO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZGVsZXRlQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG4vKioqKioqKioqKioqKioqKipcbiAqIFByZXZpZXcgSW1hZ2UgKlxuICoqKioqKioqKioqKioqKioqL1xuXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ByZXZpZXctbW9kYWwtaW1hZ2VcIik7XG5wb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2sobmFtZSwgbGluaykge1xuICBwb3B1cEltYWdlLm9wZW4obmFtZSwgbGluayk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgZGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICAoKSA9PiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufVxuLyoqKioqKioqKlxuICogTGlrZXMgKlxuICoqKioqKioqKi9cblxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcbiAgY29uc3QgaXNMaWtlZCA9IGNhcmQuZ2V0TGlrZXMoKTtcbiAgaWYgKGlzTGlrZWQpIHtcbiAgICByZXR1cm4gYXBpXG4gICAgICAudW5saWtlQ2FyZChjYXJkLmdldElkKCkpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNhcmQucmVuZGVyTGlrZXMoZmFsc2UpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVubGlraW5nIGNhcmQ6XCIsIGVycik7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBhcGlcbiAgICAgIC5saWtlQ2FyZChjYXJkLmdldElkKCkpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGNhcmQucmVuZGVyTGlrZXModHJ1ZSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBsaWtpbmcgY2FyZDpcIiwgZXJyKTtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfSk7XG4gIH1cbn1cblxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgaXRlbXM6IFtdLFxuICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICB9LFxuICB9LFxuICBcIi5jYXJkc19fbGlzdFwiXG4pO1xuXG4vKioqKioqKioqKioqKioqKipcbiAqIEluaXRpYWwgQ2FyZHMgKlxuICoqKioqKioqKioqKioqKioqL1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkcygpIHtcbiAgYXBpXG4gICAgLmluaXRpYWxDYXJkcygpXG4gICAgLnRoZW4oKGNhcmRzKSA9PiB7XG4gICAgICBjb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgICAgIHtcbiAgICAgICAgICBpdGVtczogY2FyZHMsXG4gICAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XG4gICAgICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIFwiLmNhcmRzX19saXN0XCJcbiAgICAgICk7XG4gICAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGxvYWRpbmcgaW5pdGlhbCBjYXJkczpcIiwgZXJyKTtcbiAgICB9KTtcbn1cblxucmVuZGVyQ2FyZHMoKTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgaW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHBvc3RDYXJkcyh7IG5hbWUsIGxpbmssIF9pZCB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGxpbms6IGxpbmssXG4gICAgICAgIF9pZDogX2lkLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGVkaXRVc2VySW5mbyhkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHVwZGF0ZVByb2ZpbGVQaWN0dXJlKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhciB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBhYm91dFNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Fib3V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYWJvdXRTZWxlY3Rvcik7XG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgYWJvdXQ6IHRoaXMuX2Fib3V0RWxlbWVudC50ZXh0Q29udGVudCxcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyRWxlbWVudCA/IHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjIDogbnVsbCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8obmFtZSwgYWJvdXQsIGF2YXRhcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgICBpZiAoYXZhdGFyICYmIHRoaXMuX2F2YXRhckVsZW1lbnQpIHtcbiAgICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LWltYWdlXCJcbiAgICApO1xuICAgIHRoaXMuX3BvcHVwVGl0bGUgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LXRpdGxlXCJcbiAgICApO1xuICB9XG5cbiAgb3BlbihkYXRhKSB7XG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fcG9wdXBUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGRhdGEubmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNvbmZpcm0iLCJoYW5kbGVMaWtlQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNvbmZpcm0iLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRoZW4iLCJyZW5kZXJMaWtlcyIsIl9kZWxldGVCdXR0b24iLCJfY2FyZEltYWdlRWwiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJnZXRMaWtlcyIsInJlbW92ZUNhcmQiLCJfY2FyZEVsZW1lbnQiLCJnZXRWaWV3IiwiY2FyZE5hbWVFbCIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiZ2V0SWQiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfaW5wdXRFbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9zaG93RXJyb3IiLCJpbnB1dEVsIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlRXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsImlzSW5wdXRJbnZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsImlzRm9ybUVtcHR5IiwiZXZlcnkiLCJ2YWx1ZSIsInRyaW0iLCJkaXNhYmxlZCIsImVuYWJsZUJ1dHRvbiIsImRpc2FibGVCdXR0b24iLCJpbnB1dExpc3QiLCJzb21lIiwiZm9yRWFjaCIsInJlc2V0VmFsaWRhdGlvbiIsImVuYWJsZVZhbGlkYXRpb24iLCJyZXNldCIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VCdXR0b24iLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwiX2hhbmRsZU92ZXJsYXlDbG9zZSIsImV2dCIsInRhcmdldCIsImNsb3NlIiwia2V5Iiwib3BlbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRFdmVudExpc3RlbmVycyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJfc3VibWl0QnRuIiwiX3N1Ym1pdEJ0blRleHQiLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwiY29uc29sZSIsImVycm9yIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImlucHV0Iiwic2V0SW5wdXRzVmFsdWVzIiwicHJldmVudERlZmF1bHQiLCJTZXR0aW5ncyIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImluaXRpYWxDYXJkcyIsImZldGNoIiwicG9zdENhcmRzIiwiX3JlZjIiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJlZGl0VXNlckluZm8iLCJhYm91dCIsInVwZGF0ZVByb2ZpbGVQaWN0dXJlIiwiYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJhdXRob3JpemF0aW9uIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRWRpdEZvcm0iLCJwcm9maWxlUGljdHVyZUJ1dHRvbiIsInByb2ZpbGVQaWN0dXJlTW9kYWwiLCJwcm9maWxlUGljdHVyZUZvcm0iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImFib3V0U2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9hYm91dEVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsInNldFVzZXJJbmZvIiwidXNlckRhdGEiLCJjYXRjaCIsImVyciIsImVkaXRGb3JtVmFsaWRhdG9yIiwiRm9ybVZhbGlkYXRvciIsImN1cnJlbnRVc2VySW5mbyIsInByb2ZpbGVQb3B1cCIsImZpbmFsbHkiLCJwcm9maWxlUGljdHVyZUZvcm1WYWxpZGF0b3IiLCJwcm9maWxlUGljdHVyZVBvcHVwIiwibmV3UHJvZmlsZVBpY3R1cmVVcmwiLCJ1cGRhdGVkVXNlciIsInByb2ZpbGVDYXJkTW9kYWwiLCJhZGROZXdDYXJkQnV0dG9uIiwiYWRkQ2FyZEZvcm0iLCJhZGRGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZFBvcHVwIiwibmV3Q2FyZCIsImNhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCIsInNlY3Rpb24iLCJkZWxldGVDYXJkUG9wdXAiLCJjdXJyZW50Q2FyZFRvRGVsZXRlIiwiaGlkZVNhdmluZ1RleHQiLCJkZWxldGVDYXJkU2F2ZUJ1dHRvbiIsInBvcHVwSW1hZ2UiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRpdGxlIiwiY2FyZCIsImhhbmRsZURlbGV0ZUNsaWNrIiwiY2FyZHMiXSwic291cmNlUm9vdCI6IiJ9